# Vite escapes the Bazel sandbox?

Problem: the build succeeds even if Vite dependencies (referenced in the `vite.config.js` file) are not provided as a dependency in the `BUILD.bazel` file. See:

https://github.com/henkerik/repro_rules_js_362/blob/main/BUILD.bazel#L13

Steps to reproduce:

## On OSX:

1. `git clone [this repo]`
2. `bazel build //:build`
=> The build succeeds, but a failure is expected.


## On Linux

1. `git clone [this repo]` 
2. `pnpm install`
2. `bazel build //:build`
=> The build succeeds, but a failure is expected.

Without running the `pnpm install` step, the build will fail as expected. Also, deleting the `node_modules` folder (in the root of the git repo) generated by `pnpm install` and running the Bazel build again will result in a failed build as expected.

** Note: VS Code dev container is provided to run the build on a Linux container on OSX

1. Start VS Code and start the `Dev Container: Rebuild container` command
2. Open a terminal in VS Code (shift + control + `)

** Note: On x86_64 hardware, change these lines:

- https://github.com/henkerik/repro_rules_js_362/blob/main/BUILD.bazel#L31
- https://github.com/henkerik/repro_rules_js_362/blob/main/.devcontainer/devcontainer/Dockerfile#L6

## Steps tried:

1. Tried if the patch to `node` (https://github.com/aspect-build/node/commit/6616ddd629f9417e0ac2826910ff9756b01cfe34) solved the issue, but it didn't.

2. Tried both the `processwrapper-sandbox` and the `linux-sandbox` on Linux.

3. Tried both Bazel 5.3.2 and 6.0.0RC2